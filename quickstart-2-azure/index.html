
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Documentation for k0rdent.">
      
      
        <meta name="author" content="Mirantis, Inc.">
      
      
      
        <link rel="prev" href="../quickstart-2-aws/">
      
      
        <link rel="next" href="../admin-before/">
      
      
      <link rel="icon" href="../img/favicon-32x32.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.49">
    
    
      
        <title>Configure and Deploy to Azure - Documentation</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.6f8fc17f.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../stylesheets/extra.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#quickstart-2-azure-target-environment" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Documentation" class="md-header__button md-logo" aria-label="Documentation" data-md-component="logo">
      
  <img src="../img/k0rdent-logo-horizontal-inverted.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Configure and Deploy to Azure
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6m0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4M7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/k0rdent/kcm" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Documentation" class="md-nav__button md-logo" aria-label="Documentation" data-md-component="logo">
      
  <img src="../img/k0rdent-logo-horizontal-inverted.svg" alt="logo">

    </a>
    Documentation
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/k0rdent/kcm" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Welcome to the k0rdent docs
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    k0rdent concepts
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            k0rdent concepts
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../why-k0rdent/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Why k0rdent?
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../k0rdent-architecture/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    k0rdent architecture
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    QuickStarts
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            QuickStarts
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../guide-to-quickstarts/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Guide to Quickstarts
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../quickstart-1-mgmt-node-and-cluster/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Set up Management Node and Cluster
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../quickstart-2-aws/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Configure and Deploy to AWS
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Configure and Deploy to Azure
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Configure and Deploy to Azure
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#install-the-azure-cli-az" class="md-nav__link">
    <span class="md-ellipsis">
      Install the Azure CLI (az)
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#log-in-with-azure-cli" class="md-nav__link">
    <span class="md-ellipsis">
      Log in with Azure CLI
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#register-resource-providers" class="md-nav__link">
    <span class="md-ellipsis">
      Register resource providers
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#get-your-azure-subscription-id" class="md-nav__link">
    <span class="md-ellipsis">
      Get your Azure Subscription ID
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#create-a-service-principal-for-k0rdent" class="md-nav__link">
    <span class="md-ellipsis">
      Create a Service Principal for k0rdent
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#create-a-secret-object-with-the-azure-credentials" class="md-nav__link">
    <span class="md-ellipsis">
      Create a Secret object with the Azure credentials
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#create-the-azureclusteridentity-object" class="md-nav__link">
    <span class="md-ellipsis">
      Create the AzureClusterIdentity Object
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#create-the-kcm-credential-object" class="md-nav__link">
    <span class="md-ellipsis">
      Create the KCM Credential Object
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#create-the-configmap-resource-template-object" class="md-nav__link">
    <span class="md-ellipsis">
      Create the ConfigMap resource-template Object
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#find-your-locationregion" class="md-nav__link">
    <span class="md-ellipsis">
      Find your location/region
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#list-available-cluster-templates" class="md-nav__link">
    <span class="md-ellipsis">
      List available cluster templates
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#create-your-clusterdeployment" class="md-nav__link">
    <span class="md-ellipsis">
      Create your ClusterDeployment
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#apply-the-clusterdeployment-to-deploy-the-cluster" class="md-nav__link">
    <span class="md-ellipsis">
      Apply the ClusterDeployment to deploy the cluster
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#obtain-the-clusters-kubeconfig" class="md-nav__link">
    <span class="md-ellipsis">
      Obtain the cluster's kubeconfig
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#list-child-clusters" class="md-nav__link">
    <span class="md-ellipsis">
      List child clusters
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tear-down-the-child-cluster" class="md-nav__link">
    <span class="md-ellipsis">
      Tear down the child cluster
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#next-steps" class="md-nav__link">
    <span class="md-ellipsis">
      Next Steps
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Administrator Guide
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Administrator Guide
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../admin-before/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Before you start
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../admin-installation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Installing k0rdent
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../admin-prepare/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Prepare k0rdent to create child clusters on multiple providers
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../admin-creating-clusters/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Creating standalone clusters
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../admin-adopting-clusters/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Adopting clusters
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../admin-hosted-control-planes/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Hosted control planes
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../admin-troubleshooting-aws-vpcs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Troubleshooting AWS VPCs
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../admin-service-templates/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Using and creating service templates
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../admin-create-multiclusterservice/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Creating multi-cluster services
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../admin-kof/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    k0rdent Observability & FinOps
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../admin-upgrading-k0rdent/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Upgrading k0rdent
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../admin-credentials/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    k0rdent credentials management
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../admin-rbac/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    k0rdent Role Based Access Control (RBAC)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../admin-backup/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Backing up k0rdent
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    User Guide
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            User Guide
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../user-create-cluster/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Creating clusters as a k0rdent user
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../user-create-service/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Creating and adding services to clusters as a k0rdent user
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../user-enable-drift-detection/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Enabling drift detection
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    k0rdent Templates Reference
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            k0rdent Templates Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../template-intro/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Introduction to k0rdent templates
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../template-predefined/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Removing predefined templates
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../template-byo/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Bring-your-own (BYO) templates
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../template-aws/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Templates for Amazon Web Services
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../template-azure/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Templates for Azure
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../template-openstack/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Templates for OpenStack
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../template-vsphere/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Templates for vSphere
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Known Issues
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            Known Issues
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../known-issues-eks/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    EKS
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" >
        
          
          <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Reference
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../glossary/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Glossary
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9" >
        
          
          <label class="md-nav__link" for="__nav_9" id="__nav_9_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Appendix
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9">
            <span class="md-nav__icon md-icon"></span>
            Appendix
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../appendix-extend-mgmt/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Extended management configuration
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../appendix-dryrun/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Understanding the dry run
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../appendix-providers/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cloud provider credentials management in CAPI
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10" >
        
          
          <label class="md-nav__link" for="__nav_10" id="__nav_10_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Contributing
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_10">
            <span class="md-nav__icon md-icon"></span>
            Contributing
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../k0rdent-documentation-contributors-guide/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    k0rdent documentation contributor's guide
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../k0rdent-documentation-style-guide/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    k0rdent documentation style guide
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#install-the-azure-cli-az" class="md-nav__link">
    <span class="md-ellipsis">
      Install the Azure CLI (az)
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#log-in-with-azure-cli" class="md-nav__link">
    <span class="md-ellipsis">
      Log in with Azure CLI
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#register-resource-providers" class="md-nav__link">
    <span class="md-ellipsis">
      Register resource providers
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#get-your-azure-subscription-id" class="md-nav__link">
    <span class="md-ellipsis">
      Get your Azure Subscription ID
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#create-a-service-principal-for-k0rdent" class="md-nav__link">
    <span class="md-ellipsis">
      Create a Service Principal for k0rdent
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#create-a-secret-object-with-the-azure-credentials" class="md-nav__link">
    <span class="md-ellipsis">
      Create a Secret object with the Azure credentials
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#create-the-azureclusteridentity-object" class="md-nav__link">
    <span class="md-ellipsis">
      Create the AzureClusterIdentity Object
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#create-the-kcm-credential-object" class="md-nav__link">
    <span class="md-ellipsis">
      Create the KCM Credential Object
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#create-the-configmap-resource-template-object" class="md-nav__link">
    <span class="md-ellipsis">
      Create the ConfigMap resource-template Object
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#find-your-locationregion" class="md-nav__link">
    <span class="md-ellipsis">
      Find your location/region
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#list-available-cluster-templates" class="md-nav__link">
    <span class="md-ellipsis">
      List available cluster templates
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#create-your-clusterdeployment" class="md-nav__link">
    <span class="md-ellipsis">
      Create your ClusterDeployment
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#apply-the-clusterdeployment-to-deploy-the-cluster" class="md-nav__link">
    <span class="md-ellipsis">
      Apply the ClusterDeployment to deploy the cluster
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#obtain-the-clusters-kubeconfig" class="md-nav__link">
    <span class="md-ellipsis">
      Obtain the cluster's kubeconfig
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#list-child-clusters" class="md-nav__link">
    <span class="md-ellipsis">
      List child clusters
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tear-down-the-child-cluster" class="md-nav__link">
    <span class="md-ellipsis">
      Tear down the child cluster
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#next-steps" class="md-nav__link">
    <span class="md-ellipsis">
      Next Steps
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="quickstart-2-azure-target-environment">QuickStart 2 - Azure target environment<a class="headerlink" href="#quickstart-2-azure-target-environment" title="Permanent link">#</a></h1>
<p>In this QuickStart unit, we'll be gathering information and performing preparatory steps to enable k0rdent (running on your management node) to manage clusters on Azure, and deploying a child cluster.</p>
<p>As noted in the <a href="../guide-to-quickstarts/">Guide to QuickStarts</a>, you'll need administrative access to an Azure account to complete this step. If you haven't yet created a management node and installed k0rdent, go back to <a href="../quickstart-1-mgmt-node-and-cluster/">QuickStart 1 - Management node and cluster</a>.</p>
<p>Note that if you have already done our AWS QuickStart (<a href="../quickstart-2-aws/">QuickStart 2 - AWS target environment</a>) you can use the same management cluster, continuing here with steps to add the ability to manage clusters on Azure. The k0rdent management cluster can accommodate multiple provider and credential setups, enabling management of multiple infrastructures. And even if your management node is external to Azure (for example, it could be on an AWS EC2 virtual machine), as long as you permit outbound traffic to all IP addresses from the management node, this should work fine. A big benefit of k0rdent is that it provides a single point of control and visibility across multiple clusters on multiple clouds and infrastructures.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>
<strong>Cloud Security 101:</strong> k0rdent requires <em>some</em> but not <em>all</em> permissions to manage Azure resources &mdash; doing so via the CAPZ (ClusterAPI for Azure) provider. </p>
</div>
<p>A best practice for using k0rdent with Azure (this pattern is repeated with other clouds and infrastructures) is to create a new k0rdent Azure Cluster Identity and Service Principal (SP) on your account with the particular permissions k0rdent and CAPZ require.In this section, we'll create and configure those identity abstractions, and perform other steps to make required credentials accessible to k0rdent in the management node.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>
If you're working on a shared Azure account, please ensure that the Azure Cluster Identity and Service Principal are not already set up before creating new abstractions.</p>
</div>
<p>Creating user identity abstractions with minimal required permissions is one of several principle-of-least-privilege mechanisms used to help ensure security as organizations work with k0rdent at progressively greater scales. For more on k0rdent security best practices, please see the <a href="../admin-before/">Administrator Guide</a>.</p>
<h2 id="install-the-azure-cli-az">Install the Azure CLI (az)<a class="headerlink" href="#install-the-azure-cli-az" title="Permanent link">#</a></h2>
<p>The Azure CLI (az) is required to interact with Azure resources. Install it according to instructions in <a href="https://learn.microsoft.com/en-us/cli/azure/install-azure-cli">How to install the Azure CLI</a>. For Linux/Debian (i.e., Ubuntu Server), it's one command:</p>
<div class="highlight"><pre><span></span><code>curl<span class="w"> </span>-sL<span class="w"> </span>https://aka.ms/InstallAzureCLIDeb<span class="w"> </span><span class="p">|</span><span class="w"> </span>sudo<span class="w"> </span>bash
</code></pre></div>
<h2 id="log-in-with-azure-cli">Log in with Azure CLI<a class="headerlink" href="#log-in-with-azure-cli" title="Permanent link">#</a></h2>
<p>Run the az login command to authenticate your session with Azure.</p>
<div class="highlight"><pre><span></span><code>az<span class="w"> </span>login
</code></pre></div>
<h2 id="register-resource-providers">Register resource providers<a class="headerlink" href="#register-resource-providers" title="Permanent link">#</a></h2>
<p>Azure Resource Manager uses resource providers to manage resources of all different kinds, and required providers must be registered with an Azure account before k0rdent and CAPZ can work with them.</p>
<p>You can list resources registered with your account using Azure CLI:</p>
<div class="highlight"><pre><span></span><code>az<span class="w"> </span>provider<span class="w"> </span>list<span class="w"> </span>--query<span class="w"> </span><span class="s2">&quot;[?registrationState==&#39;Registered&#39;]&quot;</span><span class="w"> </span>--output<span class="w"> </span>table
</code></pre></div>
<p>And see a listing like this:</p>
<div class="highlight"><pre><span></span><code><span class="go">Namespace                             RegistrationState</span>
<span class="go">-----------------------------------   -----------------</span>
<span class="go">Microsoft.Compute                     Registered</span>
<span class="go">Microsoft.Network                     Registered</span>
</code></pre></div>
<p>You can then select from the commands below (or enter all of them) to register any unregistered resources that k0rdent and CAPZ require:</p>
<div class="highlight"><pre><span></span><code>az<span class="w"> </span>provider<span class="w"> </span>register<span class="w"> </span>--namespace<span class="w"> </span>Microsoft.Compute
az<span class="w"> </span>provider<span class="w"> </span>register<span class="w"> </span>--namespace<span class="w"> </span>Microsoft.Network
az<span class="w"> </span>provider<span class="w"> </span>register<span class="w"> </span>--namespace<span class="w"> </span>Microsoft.ContainerService
az<span class="w"> </span>provider<span class="w"> </span>register<span class="w"> </span>--namespace<span class="w"> </span>Microsoft.ManagedIdentity
az<span class="w"> </span>provider<span class="w"> </span>register<span class="w"> </span>--namespace<span class="w"> </span>Microsoft.Authorization
</code></pre></div>
<h2 id="get-your-azure-subscription-id">Get your Azure Subscription ID<a class="headerlink" href="#get-your-azure-subscription-id" title="Permanent link">#</a></h2>
<p>Use the following command to list Azure subscriptions and their IDs:</p>
<div class="highlight"><pre><span></span><code>az<span class="w"> </span>account<span class="w"> </span>list<span class="w"> </span>-o<span class="w"> </span>table
</code></pre></div>
<p>The output will look like this:</p>
<div class="highlight"><pre><span></span><code><span class="go">Name                     SubscriptionId                    TenantId</span>
<span class="go">-----------------------  -------------------------------   -----------------------------</span>
<span class="go">My Azure Subscription    SUBSCRIPTION_ID_SUBSCRIPTION_ID   TENANT_ID_TENANT_ID_TENANT_ID</span>
</code></pre></div>
<p>The Subcription ID is in the second column.</p>
<h2 id="create-a-service-principal-for-k0rdent">Create a Service Principal for k0rdent<a class="headerlink" href="#create-a-service-principal-for-k0rdent" title="Permanent link">#</a></h2>
<p>The Service Principal is like a password-protected user that CAPZ will use to manage resources on Azure. To create it, run the following command with the Azure CLI, replacing <subscription-id> with the ID you copied earlier.</p>
<div class="highlight"><pre><span></span><code>az<span class="w"> </span>ad<span class="w"> </span>sp<span class="w"> </span>create-for-rbac<span class="w"> </span>--role<span class="w"> </span>contributor<span class="w"> </span>--scopes<span class="o">=</span><span class="s2">&quot;/subscriptions/&lt;subscription-id&gt;&quot;</span>
</code></pre></div>
<p>You'll see output that resembles what's below:</p>
<div class="highlight"><pre><span></span><code><span class="go">{</span>
<span class="go"> &quot;appId&quot;: &quot;SP_APP_ID_SP_APP_ID&quot;,</span>
<span class="go"> &quot;displayName&quot;: &quot;azure-cli-2024-10-24-17-36-47&quot;,</span>
<span class="go"> &quot;password&quot;: &quot;SP_PASSWORD_SP_PASSWORD&quot;,</span>
<span class="go"> &quot;tenant&quot;: &quot;SP_TENANT_SP_TENANT&quot;</span>
<span class="go">}</span>
</code></pre></div>
<p>Capture this output and secure the values it contains. We'll need several of these in a moment.</p>
<h2 id="create-a-secret-object-with-the-azure-credentials">Create a Secret object with the Azure credentials<a class="headerlink" href="#create-a-secret-object-with-the-azure-credentials" title="Permanent link">#</a></h2>
<p>In this quickstart we're assuming a self-managed Azure clusters (non-AKS) so create a <code>Secret</code> object that stores the <code>clientSecret</code> (password) from the Service Principal. Create a YAML file called <code>azure-cluster-identity-secret.yaml</code>, as follows, inserting the password for the Service Principal (represented by the placeholder <code>SP_PASSWORD_SP_PASSWORD</code> above):</p>
<div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">v1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Secret</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">azure-cluster-identity-secret</span>
<span class="w">  </span><span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">kcm-system</span>
<span class="w">  </span><span class="nt">labels</span><span class="p">:</span>
<span class="w">    </span><span class="nt">k0rdent.mirantis.com/component</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;kcm&quot;</span>
<span class="nt">stringData</span><span class="p">:</span>
<span class="w">  </span><span class="nt">clientSecret</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">SP_PASSWORD_SP_PASSWORD</span><span class="w"> </span><span class="c1"># Password retrieved from the Service Principal</span>
<span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Opaque</span>
</code></pre></div>
<!--
For managed (AKS) clusters on Azure create the `Secret` with the `AZURE_CLIENT_ID`, `AZURE_CLIENT_SECRET`, `AZURE_SUBSCRIPTION_ID` and `AZURE_TENANT_ID` keys set:

<div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">v1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Secret</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">azure-aks-credential</span>
<span class="w">  </span><span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">kcm-system</span>
<span class="w">  </span><span class="nt">labels</span><span class="p">:</span>
<span class="w">    </span><span class="nt">k0rdent.mirantis.com/component</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;kcm&quot;</span>
<span class="nt">stringData</span><span class="p">:</span>
<span class="w">  </span><span class="nt">AZURE_CLIENT_ID</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">&lt;SP_APP_ID_SP_APP_ID&gt;</span><span class="w"> </span><span class="c1"># AppId retrieved from the Service Principal</span>
<span class="w">  </span><span class="nt">AZURE_CLIENT_SECRET</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">&lt;SP_PASSWORD_SP_PASSWORD&gt;</span><span class="w"> </span><span class="c1"># Password retrieved from the Service Principal</span>
<span class="w">  </span><span class="nt">AZURE_SUBSCRIPTION_ID</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">&lt;SUBSCRIPTION_ID_SUBSCRIPTION_ID&gt;</span><span class="w"> </span><span class="c1"># The ID of the Subscription</span>
<span class="w">  </span><span class="nt">AZURE_TENANT_ID</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">&lt;TENANT_ID_TENANT_ID_TENANT_ID&gt;</span><span class="w"> </span><span class="c1"># TenantID retrieved from the Service Principal</span>
<span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Opaque</span>
</code></pre></div>
-->

<p>Apply the YAML to the k0rdent management cluster using the following command:</p>
<div class="highlight"><pre><span></span><code>kubectl<span class="w"> </span>apply<span class="w"> </span>-f<span class="w"> </span>azure-cluster-identity-secret.yaml
</code></pre></div>
<h2 id="create-the-azureclusteridentity-object">Create the AzureClusterIdentity Object<a class="headerlink" href="#create-the-azureclusteridentity-object" title="Permanent link">#</a></h2>
<!--
> INFO:
> Skip this step for managed (AKS) clusters.
-->
<p>This object defines the credentials k0rdent and CAPZ will use to manage Azure resources. It references the <code>Secret</code> you just created above.</p>
<p>Create a YAML file called <code>azure-cluster-identity.yaml</code>. Make sure that <code>.spec.clientSecret.name</code> matches the <code>metadata.name</code> in the file you created above.</p>
<div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">infrastructure.cluster.x-k8s.io/v1beta1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">AzureClusterIdentity</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">azure-cluster-identity</span>
<span class="w">  </span><span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">kcm-system</span>
<span class="w">  </span><span class="nt">labels</span><span class="p">:</span>
<span class="w">    </span><span class="nt">clusterctl.cluster.x-k8s.io/move-hierarchy</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;true&quot;</span>
<span class="w">    </span><span class="nt">k0rdent.mirantis.com/component</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;kcm&quot;</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="w">  </span><span class="nt">allowedNamespaces</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{}</span>
<span class="w">  </span><span class="nt">clientID</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">SP_APP_ID_SP_APP_ID</span><span class="w"> </span><span class="c1"># The App ID retrieved from the Service Principal above in Step 2</span>
<span class="w">  </span><span class="nt">clientSecret</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">azure-cluster-identity-secret</span>
<span class="w">    </span><span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">kcm-system</span>
<span class="w">  </span><span class="nt">tenantID</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">SP_TENANT_SP_TENANT</span><span class="w"> </span><span class="c1"># The Tenant ID retrieved from the Service Principal above in Step 2</span>
<span class="w">  </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ServicePrincipal</span>
</code></pre></div>
<p>Apply the YAML to your cluster:</p>
<div class="highlight"><pre><span></span><code>kubectl<span class="w"> </span>apply<span class="w"> </span>-f<span class="w"> </span>azure-cluster-identity.yaml
</code></pre></div>
<p>You should see output resembling this:</p>
<div class="highlight"><pre><span></span><code><span class="go">azureclusteridentity.infrastructure.cluster.x-k8s.io/azure-cluster-identity created</span>
</code></pre></div>
<h2 id="create-the-kcm-credential-object">Create the KCM Credential Object<a class="headerlink" href="#create-the-kcm-credential-object" title="Permanent link">#</a></h2>
<p>Create a YAML with the specification of our credential and save it as <code>azure-cluster-identity-cred.yaml</code>.</p>
<p>Note that for non-AKS clusters <code>.spec.kind</code> must be <code>AzureClusterIdentity</code>, and <code>.spec.name</code> must match <code>.metadata.name</code> of the <code>AzureClusterIdentity</code> object created in the previous step.</p>
<div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">k0rdent.mirantis.com/v1alpha1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Credential</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">azure-cluster-identity-cred</span>
<span class="w">  </span><span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">kcm-system</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="w">  </span><span class="nt">identityRef</span><span class="p">:</span>
<span class="w">    </span><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">infrastructure.cluster.x-k8s.io/v1beta1</span>
<span class="w">    </span><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">AzureClusterIdentity</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">azure-cluster-identity</span>
<span class="w">    </span><span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">kcm-system</span>
</code></pre></div>
<!--
For AKS clusters, the `.spec.identityRef.kind` must be set to `Secret`, and `.spec.name` must match
`.metadata.name` of the `Secret` object.

Note: for AKS we also need to create Cluster Identity resource template ConfigMap

<div class="highlight"><pre><span></span><code><span class="nn">---</span>
<span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">k0rdent.mirantis.com/v1alpha1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Credential</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">azure-aks-credential</span>
<span class="w">  </span><span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">kcm-system</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="w">  </span><span class="nt">identityRef</span><span class="p">:</span>
<span class="w">    </span><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">v1</span>
<span class="w">    </span><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Secret</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">azure-aks-credential</span>
<span class="w">    </span><span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">kcm-system</span>
<span class="nn">---</span>
<span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">v1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ConfigMap</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">azure-aks-credential-resource-template</span>
<span class="w">  </span><span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">kcm-system</span>
<span class="w">  </span><span class="nt">labels</span><span class="p">:</span>
<span class="w">    </span><span class="nt">k0rdent.mirantis.com/component</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;kcm&quot;</span>
<span class="w">  </span><span class="nt">annotations</span><span class="p">:</span>
<span class="w">    </span><span class="nt">projectsveltos.io/template</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;true&quot;</span>
</code></pre></div>
-->
<p>Apply the YAML to your cluster:</p>
<div class="highlight"><pre><span></span><code>kubectl<span class="w"> </span>apply<span class="w"> </span>-f<span class="w"> </span>azure-cluster-identity-cred.yaml
</code></pre></div>
<p>You should see output resembling this:</p>
<div class="highlight"><pre><span></span><code><span class="go">credential.k0rdent.mirantis.com/azure-cluster-identity-cred created</span>
</code></pre></div>
<h2 id="create-the-configmap-resource-template-object">Create the <code>ConfigMap</code> resource-template Object<a class="headerlink" href="#create-the-configmap-resource-template-object" title="Permanent link">#</a></h2>
<p>Create a YAML with the specification of our resource-template and save it as
<code>azure-cluster-identity-resource-template.yaml</code></p>
<div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">v1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ConfigMap</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">azure-cluster-identity-resource-template</span>
<span class="w">  </span><span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">kcm-system</span>
<span class="w">  </span><span class="nt">labels</span><span class="p">:</span>
<span class="w">    </span><span class="nt">k0rdent.mirantis.com/component</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;kcm&quot;</span>
<span class="w">  </span><span class="nt">annotations</span><span class="p">:</span>
<span class="w">    </span><span class="nt">projectsveltos.io/template</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;true&quot;</span>
<span class="nt">data</span><span class="p">:</span>
<span class="w">  </span><span class="nt">configmap.yaml</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<span class="w">    </span><span class="no">{{- $cluster := .InfrastructureProvider -}}</span>
<span class="w">    </span><span class="no">{{- $identity := (getResource &quot;InfrastructureProviderIdentity&quot;) -}}</span>
<span class="w">    </span><span class="no">{{- $secret := (getResource &quot;InfrastructureProviderIdentitySecret&quot;) -}}</span>
<span class="w">    </span><span class="no">{{- $subnetName := &quot;&quot; -}}</span>
<span class="w">    </span><span class="no">{{- $securityGroupName := &quot;&quot; -}}</span>
<span class="w">    </span><span class="no">{{- $routeTableName := &quot;&quot; -}}</span>
<span class="w">    </span><span class="no">{{- range $cluster.spec.networkSpec.subnets -}}</span>
<span class="w">      </span><span class="no">{{- if eq .role &quot;node&quot; -}}</span>
<span class="w">        </span><span class="no">{{- $subnetName = .name -}}</span>
<span class="w">        </span><span class="no">{{- $securityGroupName = .securityGroup.name -}}</span>
<span class="w">        </span><span class="no">{{- $routeTableName = .routeTable.name -}}</span>
<span class="w">        </span><span class="no">{{- break -}}</span>
<span class="w">      </span><span class="no">{{- end -}}</span>
<span class="w">    </span><span class="no">{{- end -}}</span>
<span class="w">    </span><span class="no">{{- $cloudConfig := dict</span>
<span class="w">      </span><span class="no">&quot;aadClientId&quot; $identity.spec.clientID</span>
<span class="w">      </span><span class="no">&quot;aadClientSecret&quot; (index $secret.data &quot;clientSecret&quot; | b64dec)</span>
<span class="w">      </span><span class="no">&quot;cloud&quot; $cluster.spec.azureEnvironment</span>
<span class="w">      </span><span class="no">&quot;loadBalancerName&quot; &quot;&quot;</span>
<span class="w">      </span><span class="no">&quot;loadBalancerSku&quot; &quot;Standard&quot;</span>
<span class="w">      </span><span class="no">&quot;location&quot; $cluster.spec.location</span>
<span class="w">      </span><span class="no">&quot;maximumLoadBalancerRuleCount&quot; 250</span>
<span class="w">      </span><span class="no">&quot;resourceGroup&quot; $cluster.spec.resourceGroup</span>
<span class="w">      </span><span class="no">&quot;routeTableName&quot; $routeTableName</span>
<span class="w">      </span><span class="no">&quot;securityGroupName&quot; $securityGroupName</span>
<span class="w">      </span><span class="no">&quot;securityGroupResourceGroup&quot; $cluster.spec.networkSpec.vnet.resourceGroup</span>
<span class="w">      </span><span class="no">&quot;subnetName&quot; $subnetName</span>
<span class="w">      </span><span class="no">&quot;subscriptionId&quot; $cluster.spec.subscriptionID</span>
<span class="w">      </span><span class="no">&quot;tenantId&quot; $identity.spec.tenantID</span>
<span class="w">      </span><span class="no">&quot;useInstanceMetadata&quot; true</span>
<span class="w">      </span><span class="no">&quot;useManagedIdentityExtension&quot; false</span>
<span class="w">      </span><span class="no">&quot;vmType&quot; &quot;vmss&quot;</span>
<span class="w">      </span><span class="no">&quot;vnetName&quot; $cluster.spec.networkSpec.vnet.name</span>
<span class="w">      </span><span class="no">&quot;vnetResourceGroup&quot; $cluster.spec.networkSpec.vnet.resourceGroup</span>
<span class="w">    </span><span class="no">-}}</span>
<span class="w">    </span><span class="no">---</span>
<span class="w">    </span><span class="no">apiVersion: v1</span>
<span class="w">    </span><span class="no">kind: Secret</span>
<span class="w">    </span><span class="no">metadata:</span>
<span class="w">      </span><span class="no">name: azure-cloud-provider</span>
<span class="w">      </span><span class="no">namespace: kube-system</span>
<span class="w">    </span><span class="no">type: Opaque</span>
<span class="w">    </span><span class="no">data:</span>
<span class="w">      </span><span class="no">cloud-config: {{ $cloudConfig | toJson | b64enc }}</span>
</code></pre></div>
<p>Object name needs to be exactly <code>azure-cluster-identity-resource-template.yaml</code>, <code>AzureClusterIdentity</code> object name + <code>-resource-template</code> string suffix.</p>
<p>Apply the YAML to your cluster:</p>
<p><div class="highlight"><pre><span></span><code>kubectl<span class="w"> </span>apply<span class="w"> </span>-f<span class="w"> </span>azure-cluster-identity-resource-template.yaml
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="go">configmap/azure-cluster-identity-resource-template created</span>
</code></pre></div></p>
<h2 id="find-your-locationregion">Find your location/region<a class="headerlink" href="#find-your-locationregion" title="Permanent link">#</a></h2>
<p>To determine where to deploy your cluster, you may wish to begin by listing your Azure location/regions:</p>
<div class="highlight"><pre><span></span><code>az<span class="w"> </span>account<span class="w"> </span>list-locations<span class="w"> </span>-o<span class="w"> </span>table
</code></pre></div>
<p>You'll see output like this:</p>
<div class="highlight"><pre><span></span><code><span class="go">DisplayName               Name                 RegionalDisplayName</span>
<span class="go">------------------------  -------------------  -------------------------------------</span>
<span class="go">East US                   eastus               (US) East US</span>
<span class="go">South Central US          southcentralus       (US) South Central US</span>
<span class="go">West US 2                 westus2              (US) West US 2</span>
<span class="go">West US 3                 westus3              (US) West US 3</span>
<span class="go">Australia East            australiaeast        (Asia Pacific) Australia East</span>
<span class="go">. . .</span>
</code></pre></div>
<p>What you'll need to insert in your ClusterDeployment is the name (center column) of the region you wish to deploy to.</p>
<h2 id="list-available-cluster-templates">List available cluster templates<a class="headerlink" href="#list-available-cluster-templates" title="Permanent link">#</a></h2>
<p>k0rdent is now fully configured to manage Azure. To create a cluster, begin by listing the available ClusterTemplates provided with k0rdent:</p>
<div class="highlight"><pre><span></span><code>kubectl<span class="w"> </span>get<span class="w"> </span>clustertemplate<span class="w"> </span>-n<span class="w"> </span>kcm-system
</code></pre></div>
<p>You'll see output resembling what's below. Grab the name of the AWS standalone cluster template in its present version (in the example below, that's <code>azure-standalone-cp-0-1-0</code>):</p>
<div class="highlight"><pre><span></span><code><span class="go">NAMESPACE    NAME                            VALID</span>
<span class="go">kcm-system   adopted-cluster-0-1-0           true</span>
<span class="go">kcm-system   aws-eks-0-1-0                   true</span>
<span class="go">kcm-system   aws-hosted-cp-0-1-0             true</span>
<span class="go">kcm-system   aws-standalone-cp-0-1-0         true</span>
<span class="go">kcm-system   azure-aks-0-1-0                 true</span>
<span class="go">kcm-system   azure-hosted-cp-0-1-0           true</span>
<span class="go">kcm-system   azure-standalone-cp-0-1-0       true</span>
<span class="go">kcm-system   openstack-standalone-cp-0-1-0   true</span>
<span class="go">kcm-system   vsphere-hosted-cp-0-1-0         true</span>
<span class="go">kcm-system   vsphere-standalone-cp-0-1-0     true</span>
</code></pre></div>
<h2 id="create-your-clusterdeployment">Create your ClusterDeployment<a class="headerlink" href="#create-your-clusterdeployment" title="Permanent link">#</a></h2>
<p>Now, to deploy a cluster, create a YAML file called <code>my-azure-clusterdeployment1.yaml</code>. We'll use this to create a ClusterDeployment object in k0rdent, representing the deployed cluster. The <code>ClusterDeployment</code> identifies for k0rdent the <code>ClusterTemplate</code> you want to use for cluster creation, the identity credential object you want to create it under, plus the location/region and instance types you want to use to host control plane and worker nodes:</p>
<div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">k0rdent.mirantis.com/v1alpha1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ClusterDeployment</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">my-azure-clusterdeployment1</span>
<span class="w">  </span><span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">kcm-system</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="w">  </span><span class="nt">template</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">azure-standalone-cp-0-1-0</span><span class="w"> </span><span class="c1"># name of the clustertemplate</span>
<span class="w">  </span><span class="nt">credential</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">azure-cluster-identity-cred</span>
<span class="w">  </span><span class="nt">config</span><span class="p">:</span>
<span class="w">    </span><span class="nt">clusterLabels</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{}</span>
<span class="w">    </span><span class="nt">location</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;AZURE_LOCATION&quot;</span><span class="w"> </span><span class="c1"># Select your desired Azure Location</span>
<span class="w">    </span><span class="nt">subscriptionID</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">SUBSCRIPTION_ID_SUBSCRIPTION_ID</span><span class="w"> </span><span class="c1"># Enter the Subscription ID used earlier</span>
<span class="w">    </span><span class="nt">controlPlane</span><span class="p">:</span>
<span class="w">      </span><span class="nt">vmSize</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Standard_A4_v2</span>
<span class="w">    </span><span class="nt">worker</span><span class="p">:</span>
<span class="w">      </span><span class="nt">vmSize</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Standard_A4_v2</span>
</code></pre></div>
<!-- 
For AKS clusters, the `ClusterDeployment` looks like this:

<div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">k0rdent.mirantis.com/v1alpha1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ClusterDeployment</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">my-azure-clusterdeployment1</span>
<span class="w">  </span><span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">kcm-system</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="w">  </span><span class="nt">template</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">azure-aks-0-1-0</span>
<span class="w">  </span><span class="nt">credential</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">azure-aks-credential</span>
<span class="w">  </span><span class="nt">propagateCredentials</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span><span class="w"> </span><span class="c1"># Should be set to `false`</span>
<span class="w">  </span><span class="nt">config</span><span class="p">:</span>
<span class="w">    </span><span class="nt">clusterLabels</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{}</span>
<span class="w">    </span><span class="nt">location</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;westus&quot;</span><span class="w"> </span><span class="c1"># Select your desired Azure Location (find it via `az account list-locations -o table`)</span>
<span class="w">    </span><span class="nt">machinePools</span><span class="p">:</span>
<span class="w">      </span><span class="nt">system</span><span class="p">:</span>
<span class="w">        </span><span class="nt">vmSize</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Standard_A4_v2</span>
<span class="w">      </span><span class="nt">user</span><span class="p">:</span>
<span class="w">        </span><span class="nt">vmSize</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Standard_A4_v2</span>
</code></pre></div>
-->

<h2 id="apply-the-clusterdeployment-to-deploy-the-cluster">Apply the ClusterDeployment to deploy the cluster<a class="headerlink" href="#apply-the-clusterdeployment-to-deploy-the-cluster" title="Permanent link">#</a></h2>
<p>Finally, we'll apply the ClusterDeployment YAML (<code>my-azure-clusterdeployment1.yaml</code>) to instruct k0rdent to deploy the cluster:</p>
<div class="highlight"><pre><span></span><code>kubectl<span class="w"> </span>apply<span class="w"> </span>-f<span class="w"> </span>my-azure-clusterdeployment1.yaml
</code></pre></div>
<p>Kubernetes should confirm this:</p>
<div class="highlight"><pre><span></span><code><span class="go">clusterdeployment.k0rdent.mirantis.com/my-azure-clusterdeployment1 created</span>
</code></pre></div>
<p>There will be a delay as the cluster finishes provisioning. Follow the provisioning process with the following command:</p>
<div class="highlight"><pre><span></span><code>kubectl<span class="w"> </span>-n<span class="w"> </span>kcm-system<span class="w"> </span>get<span class="w"> </span>clusterdeployment.k0rdent.mirantis.com<span class="w"> </span>my-azure-clusterdeployment1<span class="w"> </span>--watch
</code></pre></div>
<h2 id="obtain-the-clusters-kubeconfig">Obtain the cluster's kubeconfig<a class="headerlink" href="#obtain-the-clusters-kubeconfig" title="Permanent link">#</a></h2>
<p>Now you can retrieve the cluster's kubeconfig:</p>
<div class="highlight"><pre><span></span><code>kubectl<span class="w"> </span>-n<span class="w"> </span>kcm-system<span class="w"> </span>get<span class="w"> </span>secret<span class="w"> </span>my-azure-clusterdeployment1-kubeconfig<span class="w"> </span>-o<span class="w"> </span><span class="nv">jsonpath</span><span class="o">=</span><span class="s1">&#39;{.data.value}&#39;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>base64<span class="w"> </span>-d<span class="w"> </span>&gt;<span class="w"> </span>my-azure-clusterdeployment1-kubeconfig.kubeconfig
</code></pre></div>
<p>And you can use the kubeconfig to see what's running on the cluster:</p>
<div class="highlight"><pre><span></span><code><span class="nv">KUBECONFIG</span><span class="o">=</span><span class="s2">&quot;my-azure-clusterdeployment1-kubeconfig.kubeconfig&quot;</span><span class="w"> </span>kubectl<span class="w"> </span>get<span class="w"> </span>pods<span class="w"> </span>-A
</code></pre></div>
<h2 id="list-child-clusters">List child clusters<a class="headerlink" href="#list-child-clusters" title="Permanent link">#</a></h2>
<p>To verify the presence of the child cluster, list the available <code>ClusterDeployment</code> objects:</p>
<p><div class="highlight"><pre><span></span><code>kubectl<span class="w"> </span>get<span class="w"> </span>ClusterDeployments<span class="w"> </span>-A
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="go">NAMESPACE    NAME                          READY   STATUS</span>
<span class="go">kcm-system   my-azure-clusterdeployment1   True    ClusterDeployment is ready</span>
</code></pre></div></p>
<h2 id="tear-down-the-child-cluster">Tear down the child cluster<a class="headerlink" href="#tear-down-the-child-cluster" title="Permanent link">#</a></h2>
<p>To tear down the child cluster, delete the <code>ClusterDeployment</code>:</p>
<p><div class="highlight"><pre><span></span><code>kubectl<span class="w"> </span>delete<span class="w"> </span>ClusterDeployment<span class="w"> </span>my-azure-clusterdeployment1<span class="w"> </span>-n<span class="w"> </span>kcm-system
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="go">clusterdeployment.k0rdent.mirantis.com &quot;my-azure-clusterdeployment1&quot; deleted</span>
</code></pre></div></p>
<h2 id="next-steps">Next Steps<a class="headerlink" href="#next-steps" title="Permanent link">#</a></h2>
<p>Now that you've finished the k0rdent QuickStart, we have some suggestions for what to do next:</p>
<p>Check out the <a href="../admin-before/">Administrator Guide</a> ...</p>
<ul>
<li>For a more detailed view of k0rdent setup for production</li>
<li>For details about setting up k0rdent to manage clusters on VMware and OpenStack</li>
<li>For details about using k0rdent with cloud Kubernetes distros: AWS EKS and Azure AKS</li>
</ul>
<p>Or check out the <a href="https://github.com/k0rdent/demos">Demos Repository</a> for fast, makefile-driven demos of k0rdent's key features!</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2025 The k0rdent authors | Documentation distributed under <a href="https://creativecommons.org/licenses/by/4.0/legalcode.txt">CC-BY-4.0</a>.
    </div>
  
  
</div>
      
        <div class="md-social">
  
    
    
    
    
    <a href="https://github.com/k0rdent/kcm" target="_blank" rel="noopener" title="k0rdent on GitHub" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
    
    
    
    
    <a href="https://x.com/k0rdent" target="_blank" rel="noopener" title="k0rdent on X" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M389.2 48h70.6L305.6 224.2 487 464H345L233.7 318.6 106.5 464H35.8l164.9-188.5L26.8 48h145.6l100.5 132.9zm-24.8 373.8h39.1L151.1 88h-42z"/></svg>
    </a>
  
    
    
    
    
    <a href="https://bsky.app/profile/k0rdent.bsky.social" target="_blank" rel="noopener" title="k0rdent on BlueSky" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M111.8 62.2C170.2 105.9 233 194.7 256 242.4c23-47.6 85.8-136.4 144.2-180.2 42.1-31.6 110.3-56 110.3 21.8 0 15.5-8.9 130.5-14.1 149.2-18.2 64.8-84.4 81.4-143.3 71.3C456 322 482.2 380 425.6 438c-107.4 110.2-154.3-27.6-166.3-62.9-1.7-4.9-2.6-7.8-3.3-7.8s-1.6 3-3.3 7.8c-12 35.3-59 173.1-166.3 62.9-56.5-58-30.4-116 72.5-133.5C100 314.6 33.8 298 15.7 233.1 10.4 214.4 1.5 99.4 1.5 83.9c0-77.8 68.2-53.4 110.3-21.8z"/></svg>
    </a>
  
    
    
    
    
    <a href="https://www.youtube.com/channel/UChXQ6kbvjnAtdZAQpl7Fo4A" target="_blank" rel="noopener" title="k0rdent on YouTube" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!--! Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M549.655 124.083c-6.281-23.65-24.787-42.276-48.284-48.597C458.781 64 288 64 288 64S117.22 64 74.629 75.486c-23.497 6.322-42.003 24.947-48.284 48.597-11.412 42.867-11.412 132.305-11.412 132.305s0 89.438 11.412 132.305c6.281 23.65 24.787 41.5 48.284 47.821C117.22 448 288 448 288 448s170.78 0 213.371-11.486c23.497-6.321 42.003-24.171 48.284-47.821 11.412-42.867 11.412-132.305 11.412-132.305s0-89.438-11.412-132.305m-317.51 213.508V175.185l142.739 81.205z"/></svg>
    </a>
  
    
    
    
    
    <a href="https://www.linkedin.com/company/k0rdent/" target="_blank" rel="noopener" title="k0rdent on LinkedIn" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3M135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5m282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": ["toc.autohide", "search.suggest", "search.highlight", "content.code.copy"], "search": "../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"default": "stable", "provider": "mike"}}</script>
    
    
      <script src="../assets/javascripts/bundle.88dd0f4e.min.js"></script>
      
    
  </body>
</html>